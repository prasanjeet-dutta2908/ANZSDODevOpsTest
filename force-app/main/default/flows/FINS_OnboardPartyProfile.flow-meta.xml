<?xml version="1.0" encoding="UTF-8"?>
<Flow xmlns="http://soap.sforce.com/2006/04/metadata">
    <apiVersion>59.0</apiVersion>
    <areMetricsLoggedToDataCloud>false</areMetricsLoggedToDataCloud>
    <decisions>
        <description>Checks the status of the Flow Orchestration Instance Related Object record to determine whether to restart the orchestration run or terminate it.</description>
        <name>CheckFlowOrchInstRelatedObjectStatus</name>
        <label>What is the Flow Orchestration Instance Related Object Status?</label>
        <locationX>176</locationX>
        <locationY>2219</locationY>
        <defaultConnectorLabel>Other (Default)</defaultConnectorLabel>
        <rules>
            <name>isRestart</name>
            <conditionLogic>and</conditionLogic>
            <conditions>
                <leftValueReference>EvaluateWhetherFlowConditionsMet.Outputs.flowOrchestrationInstRelatedObjStatus</leftValueReference>
                <operator>EqualTo</operator>
                <rightValue>
                    <stringValue>Restarted</stringValue>
                </rightValue>
            </conditions>
            <connector>
                <isGoTo>true</isGoTo>
                <targetReference>PerformPartyProfilePreOnboardingActions</targetReference>
            </connector>
            <label>Restart</label>
        </rules>
        <rules>
            <name>isTerminate</name>
            <conditionLogic>and</conditionLogic>
            <conditions>
                <leftValueReference>EvaluateWhetherFlowConditionsMet.Outputs.flowOrchestrationInstRelatedObjStatus</leftValueReference>
                <operator>EqualTo</operator>
                <rightValue>
                    <stringValue>FinishedWithErrors</stringValue>
                </rightValue>
            </conditions>
            <label>Terminate</label>
        </rules>
    </decisions>
    <decisions>
        <description>Determines the stage of the Party Profile record to decide whether to restart the orchestration instance or process the party profile onboarding.</description>
        <name>CheckStageThePartyProfile</name>
        <label>What is the Stage of the Party Profile?</label>
        <locationX>550</locationX>
        <locationY>503</locationY>
        <defaultConnectorLabel>Other (Default)</defaultConnectorLabel>
        <rules>
            <name>IsInitiated</name>
            <conditionLogic>and</conditionLogic>
            <conditions>
                <leftValueReference>InitiatePreOnboardingProcess.Outputs.partyProfile.Stage</leftValueReference>
                <operator>EqualTo</operator>
                <rightValue>
                    <stringValue>Initiated</stringValue>
                </rightValue>
            </conditions>
            <connector>
                <targetReference>PerformPartyProfileIdentityVerification</targetReference>
            </connector>
            <label>Initiated</label>
        </rules>
        <rules>
            <name>IsRiskSceening</name>
            <conditionLogic>and</conditionLogic>
            <conditions>
                <leftValueReference>InitiatePreOnboardingProcess.Outputs.partyProfile.Stage</leftValueReference>
                <operator>EqualTo</operator>
                <rightValue>
                    <stringValue>Risk Screening</stringValue>
                </rightValue>
            </conditions>
            <connector>
                <targetReference>PerformPartyProfileIdentityVerification</targetReference>
            </connector>
            <label>Risk Screening</label>
        </rules>
        <rules>
            <name>IsRiskAssessment</name>
            <conditionLogic>and</conditionLogic>
            <conditions>
                <leftValueReference>InitiatePreOnboardingProcess.Outputs.partyProfile.Stage</leftValueReference>
                <operator>EqualTo</operator>
                <rightValue>
                    <stringValue>Risk Assessment</stringValue>
                </rightValue>
            </conditions>
            <connector>
                <isGoTo>true</isGoTo>
                <targetReference>PerformRiskAssessment</targetReference>
            </connector>
            <label>Risk Assessment</label>
        </rules>
        <rules>
            <name>IsApproval</name>
            <conditionLogic>and</conditionLogic>
            <conditions>
                <leftValueReference>InitiatePreOnboardingProcess.Outputs.partyProfile.Stage</leftValueReference>
                <operator>EqualTo</operator>
                <rightValue>
                    <stringValue>Approvals</stringValue>
                </rightValue>
            </conditions>
            <connector>
                <isGoTo>true</isGoTo>
                <targetReference>InitiateApprovalProcess</targetReference>
            </connector>
            <label>Approval</label>
        </rules>
        <rules>
            <name>isDocumentValidation</name>
            <conditionLogic>and</conditionLogic>
            <conditions>
                <leftValueReference>InitiatePreOnboardingProcess.Outputs.partyProfile.Stage</leftValueReference>
                <operator>EqualTo</operator>
                <rightValue>
                    <stringValue>Document Validation</stringValue>
                </rightValue>
            </conditions>
            <connector>
                <isGoTo>true</isGoTo>
                <targetReference>PerformRiskAssessment</targetReference>
            </connector>
            <label>Document Validation</label>
        </rules>
    </decisions>
    <decisions>
        <description>Determines whether the risk assessment for the party profile failed before submitting the party profile to the approval process.</description>
        <name>DidRiskAssessmentFail</name>
        <label>Did Risk Assessment Fail?</label>
        <locationX>968</locationX>
        <locationY>1343</locationY>
        <defaultConnector>
            <targetReference>InitiateApprovalProcess</targetReference>
        </defaultConnector>
        <defaultConnectorLabel>No (Default)</defaultConnectorLabel>
        <rules>
            <name>RiskAssessmentFailed</name>
            <conditionLogic>and</conditionLogic>
            <conditions>
                <leftValueReference>InitiateRiskAssessment.Outputs.IsFlowFailed</leftValueReference>
                <operator>EqualTo</operator>
                <rightValue>
                    <booleanValue>true</booleanValue>
                </rightValue>
            </conditions>
            <connector>
                <targetReference>HandleExceptions</targetReference>
            </connector>
            <label>Yes</label>
        </rules>
    </decisions>
    <decisions>
        <description>Determines whether the approval requested for the party profile failed.</description>
        <name>IsApprovalProcessFailed</name>
        <label>Is Approval Process Failed?</label>
        <locationX>1100</locationX>
        <locationY>1559</locationY>
        <defaultConnectorLabel>Other (Default)</defaultConnectorLabel>
        <rules>
            <name>ApprovalProcessIsFailed</name>
            <conditionLogic>and</conditionLogic>
            <conditions>
                <leftValueReference>UpdateApplicantStage.Outputs.isFlowFailed</leftValueReference>
                <operator>EqualTo</operator>
                <rightValue>
                    <booleanValue>true</booleanValue>
                </rightValue>
            </conditions>
            <connector>
                <targetReference>HandleExceptions</targetReference>
            </connector>
            <label>Yes</label>
        </rules>
    </decisions>
    <decisions>
        <description>Determines whether the pre-onboarding process for the party profile was completed or not.</description>
        <name>IsThePreOnboardingProcessCompleted</name>
        <label>Is the Pre-Onboarding Process Completed?</label>
        <locationX>176</locationX>
        <locationY>395</locationY>
        <defaultConnector>
            <targetReference>CheckStageThePartyProfile</targetReference>
        </defaultConnector>
        <defaultConnectorLabel>Yes (Default)</defaultConnectorLabel>
        <rules>
            <name>PreOnboardingProcessNotCompleted</name>
            <conditionLogic>and</conditionLogic>
            <conditions>
                <leftValueReference>InitiatePreOnboardingProcess.Outputs.isFlowFailed</leftValueReference>
                <operator>EqualTo</operator>
                <rightValue>
                    <booleanValue>true</booleanValue>
                </rightValue>
            </conditions>
            <connector>
                <targetReference>HandleExceptions</targetReference>
            </connector>
            <label>No</label>
        </rules>
    </decisions>
    <decisions>
        <description>Checks the outcome of the identity verification and screening checks for the Party Profile to determine if they are valid for processing the risk assessment for the party profile.</description>
        <name>WhatIsStatusOfIdentityVerfAndScrnCheck</name>
        <label>What is the Status of Identity Verification and Screening Check</label>
        <locationX>550</locationX>
        <locationY>1127</locationY>
        <defaultConnector>
            <targetReference>PerformRiskAssessment</targetReference>
        </defaultConnector>
        <defaultConnectorLabel>Other</defaultConnectorLabel>
        <rules>
            <name>IsRetry</name>
            <conditionLogic>or</conditionLogic>
            <conditions>
                <leftValueReference>ReviewIdentityVerificationAndScreeningStatus.Outputs.reattemptIdentityVerification</leftValueReference>
                <operator>EqualTo</operator>
                <rightValue>
                    <booleanValue>true</booleanValue>
                </rightValue>
            </conditions>
            <conditions>
                <leftValueReference>ReviewIdentityVerificationAndScreeningStatus.Outputs.reattemptScreeningChecks</leftValueReference>
                <operator>EqualTo</operator>
                <rightValue>
                    <booleanValue>true</booleanValue>
                </rightValue>
            </conditions>
            <connector>
                <isGoTo>true</isGoTo>
                <targetReference>PerformPartyProfileIdentityVerification</targetReference>
            </connector>
            <label>Retry</label>
        </rules>
        <rules>
            <name>IsError</name>
            <conditionLogic>1 AND (2 OR 3)</conditionLogic>
            <conditions>
                <leftValueReference>ReviewIdentityVerificationAndScreeningStatus.Outputs.isFlowFailed</leftValueReference>
                <operator>EqualTo</operator>
                <rightValue>
                    <booleanValue>true</booleanValue>
                </rightValue>
            </conditions>
            <conditions>
                <leftValueReference>ReviewIdentityVerificationAndScreeningStatus.Outputs.reattemptIdentityVerification</leftValueReference>
                <operator>EqualTo</operator>
                <rightValue>
                    <booleanValue>false</booleanValue>
                </rightValue>
            </conditions>
            <conditions>
                <leftValueReference>ReviewIdentityVerificationAndScreeningStatus.Outputs.reattemptScreeningChecks</leftValueReference>
                <operator>EqualTo</operator>
                <rightValue>
                    <booleanValue>false</booleanValue>
                </rightValue>
            </conditions>
            <connector>
                <targetReference>HandleExceptions</targetReference>
            </connector>
            <label>Error</label>
        </rules>
        <rules>
            <name>IsCompleted</name>
            <conditionLogic>and</conditionLogic>
            <conditions>
                <leftValueReference>ReviewIdentityVerificationAndScreeningStatus.Outputs.isFlowFailed</leftValueReference>
                <operator>EqualTo</operator>
                <rightValue>
                    <booleanValue>false</booleanValue>
                </rightValue>
            </conditions>
            <connector>
                <isGoTo>true</isGoTo>
                <targetReference>PerformRiskAssessment</targetReference>
            </connector>
            <label>Completed</label>
        </rules>
    </decisions>
    <description>When the Flow Orchestration Instance Reference Object record is created with the Reference Object as Party Profile, this flow orchestration processes the Party Profile record for identity verification, risk assessment, and screening checks.</description>
    <environments>Default</environments>
    <formulas>
        <description>Builds the error message</description>
        <name>ErrorMessage</name>
        <dataType>String</dataType>
        <expression>{!ReviewIdentityVerificationAndScreeningStatus.Outputs.errorMessage}</expression>
    </formulas>
    <interviewLabel>Onboarding: Process a Party Profile to Onboard a New Applicant {!$Flow.CurrentDateTime}</interviewLabel>
    <label>Onboarding: Process a Party Profile to Onboard a New Applicant</label>
    <orchestratedStages>
        <description>Handles exceptions and determines whether the flow orchestration conditions were met.</description>
        <name>HandleExceptions</name>
        <label>Handle Exceptions</label>
        <locationX>176</locationX>
        <locationY>2111</locationY>
        <connector>
            <targetReference>CheckFlowOrchInstRelatedObjectStatus</targetReference>
        </connector>
        <exitConditionLogic>and</exitConditionLogic>
        <stageSteps>
            <description>If the status of the flow orchestration instance is set to Failed, the flow creates a Process Exception record to process the errors. The flow then updates the stage of the Flow Orchestration Inst Related Obj record to Fix Exceptions. Otherwise, displays an error to the flow user.</description>
            <name>HandleErrorsWithProcessException</name>
            <actionName>fsc_onboarding__ProcessRunErrors</actionName>
            <actionType>stepBackground</actionType>
            <canAssigneeEdit>false</canAssigneeEdit>
            <debugSimulateStep>false</debugSimulateStep>
            <entryConditionLogic>and</entryConditionLogic>
            <exitConditionLogic>and</exitConditionLogic>
            <inputParameters>
                <name>AttachedToID</name>
                <value>
                    <elementReference>$Record.RelatedObjectId</elementReference>
                </value>
            </inputParameters>
            <inputParameters>
                <name>FlowOrchestrationInstRelatedObjID</name>
                <value>
                    <elementReference>$Record.Id</elementReference>
                </value>
            </inputParameters>
            <inputParameters>
                <name>Description</name>
                <value>
                    <elementReference>ErrorMessage</elementReference>
                </value>
            </inputParameters>
            <inputParameters>
                <name>Message</name>
                <value>
                    <stringValue>We couldn&apos;t complete the Orchestration run. Try again or contact Salesforce Customer Support for help. </stringValue>
                </value>
            </inputParameters>
            <label>Handle Errors with Process Exception</label>
            <requiresAsyncProcessing>false</requiresAsyncProcessing>
            <runAsUser>true</runAsUser>
            <shouldLock>false</shouldLock>
            <stepSubtype>BackgroundStep</stepSubtype>
        </stageSteps>
        <stageSteps>
            <description>Checks the status of the Flow Orchestration Instance Related Object record. If the status is Finished with Errors or is Restarted, the flow sets the value of the isOrchestrationConditionMet variable to True. Else, the flow sets the value of the isOrchestrationConditionMet variable to False.</description>
            <name>EvaluateWhetherFlowConditionsMet</name>
            <actionName>fsc_onboarding__ResumeIfIsFixExcp</actionName>
            <actionType>stepBackground</actionType>
            <canAssigneeEdit>false</canAssigneeEdit>
            <debugSimulateStep>false</debugSimulateStep>
            <entryActionInputParameters>
                <name>flowOrchestrationInstRelatedObjID</name>
                <value>
                    <elementReference>$Record.Id</elementReference>
                </value>
            </entryActionInputParameters>
            <entryActionName>fsc_onboarding__EvalResumeCondition</entryActionName>
            <entryActionType>evaluationFlow</entryActionType>
            <entryConditionLogic>and</entryConditionLogic>
            <exitConditionLogic>and</exitConditionLogic>
            <inputParameters>
                <name>flowOrchestrationInstRelatedObjId</name>
                <value>
                    <elementReference>$Record.Id</elementReference>
                </value>
            </inputParameters>
            <label>Evaluate Whether Flow Conditions Met</label>
            <requiresAsyncProcessing>false</requiresAsyncProcessing>
            <runAsUser>true</runAsUser>
            <shouldLock>false</shouldLock>
            <stepSubtype>BackgroundStep</stepSubtype>
        </stageSteps>
    </orchestratedStages>
    <orchestratedStages>
        <description>Requests approval for the Party Profile record and performs post-approval actions.</description>
        <name>InitiateApprovalProcess</name>
        <label>Initiate Approval Process</label>
        <locationX>1100</locationX>
        <locationY>1451</locationY>
        <connector>
            <targetReference>IsApprovalProcessFailed</targetReference>
        </connector>
        <exitConditionLogic>and</exitConditionLogic>
        <stageSteps>
            <description>Sends the Party Profile record to an approval process action.</description>
            <name>RequestsApprovals</name>
            <actionName>fsc_onboarding__RequestApproval</actionName>
            <actionType>stepBackground</actionType>
            <canAssigneeEdit>false</canAssigneeEdit>
            <debugSimulateStep>false</debugSimulateStep>
            <entryConditionLogic>and</entryConditionLogic>
            <exitConditionLogic>and</exitConditionLogic>
            <inputParameters>
                <name>partyProfileId</name>
                <value>
                    <elementReference>$Record.RelatedObjectId</elementReference>
                </value>
            </inputParameters>
            <label>Request Approvals</label>
            <requiresAsyncProcessing>false</requiresAsyncProcessing>
            <runAsUser>true</runAsUser>
            <shouldLock>false</shouldLock>
            <stepSubtype>BackgroundStep</stepSubtype>
        </stageSteps>
        <stageSteps>
            <description>Checks the approval status of the Party Profile record. If the record is approved, the flow updates the Applicant stage to Approved. Otherwise, the flow updates the Applicant stage to Rejected.</description>
            <name>UpdateApplicantStage</name>
            <actionName>fsc_onboarding__UpdateApplicantStage</actionName>
            <actionType>stepBackground</actionType>
            <canAssigneeEdit>false</canAssigneeEdit>
            <debugSimulateStep>false</debugSimulateStep>
            <entryActionInputParameters>
                <name>partyProfileId</name>
                <value>
                    <elementReference>$Record.RelatedObjectId</elementReference>
                </value>
            </entryActionInputParameters>
            <entryActionName>fsc_onboarding__IsPartyProfileApproved</entryActionName>
            <entryActionType>evaluationFlow</entryActionType>
            <entryConditionLogic>and</entryConditionLogic>
            <exitConditionLogic>and</exitConditionLogic>
            <inputParameters>
                <name>errorMessage</name>
                <value>
                    <elementReference>RequestsApprovals.Outputs.errorMessage</elementReference>
                </value>
            </inputParameters>
            <inputParameters>
                <name>isFlowFailed</name>
                <value>
                    <elementReference>RequestsApprovals.Outputs.isFlowFailed</elementReference>
                </value>
            </inputParameters>
            <inputParameters>
                <name>partyProfileID</name>
                <value>
                    <elementReference>$Record.RelatedObjectId</elementReference>
                </value>
            </inputParameters>
            <inputParameters>
                <name>FlowOrchInstRelaObjectId</name>
                <value>
                    <elementReference>$Record.Id</elementReference>
                </value>
            </inputParameters>
            <label>Update Applicant Stage</label>
            <requiresAsyncProcessing>false</requiresAsyncProcessing>
            <runAsUser>true</runAsUser>
            <shouldLock>false</shouldLock>
            <stepSubtype>BackgroundStep</stepSubtype>
        </stageSteps>
    </orchestratedStages>
    <orchestratedStages>
        <description>The flow orchestration initiates the identity verification for the party profile if it isn&apos;t complete.</description>
        <name>PerformPartyProfileIdentityVerification</name>
        <label>Perform Party Profile Identity Verification</label>
        <locationX>550</locationX>
        <locationY>803</locationY>
        <connector>
            <targetReference>PerformPartyProfileScreeningChecks</targetReference>
        </connector>
        <exitActionInputParameters>
            <name>isFlowFailed</name>
            <value>
                <elementReference>InitiateIdentityVerification.Outputs.isFlowFailed</elementReference>
            </value>
        </exitActionInputParameters>
        <exitActionInputParameters>
            <name>PartyProfileID</name>
            <value>
                <elementReference>$Record.RelatedObjectId</elementReference>
            </value>
        </exitActionInputParameters>
        <exitActionName>fsc_onboarding__CheckIdVerfComplete</exitActionName>
        <exitActionType>evaluationFlow</exitActionType>
        <exitConditionLogic>and</exitConditionLogic>
        <stageSteps>
            <description>Checks the stage of the Party Profile and the status of its identity verification. If the identity verification status is Completed, the flow sets the variable isOrchestrationConditionMet to False. Otherwise, the flow orchestration calls an integration definition to initiate the identity verification for the Party Profile.</description>
            <name>InitiateIdentityVerification</name>
            <actionName>fsc_onboarding__InvokeExtlAsyncAction</actionName>
            <actionType>stepBackground</actionType>
            <canAssigneeEdit>false</canAssigneeEdit>
            <debugSimulateStep>false</debugSimulateStep>
            <entryActionInputParameters>
                <name>partyProfileId</name>
                <value>
                    <elementReference>$Record.RelatedObjectId</elementReference>
                </value>
            </entryActionInputParameters>
            <entryActionName>fsc_onboarding__VerifyIDVCompletion</entryActionName>
            <entryActionType>evaluationFlow</entryActionType>
            <entryConditionLogic>and</entryConditionLogic>
            <exitConditionLogic>and</exitConditionLogic>
            <inputParameters>
                <name>inputRecordID</name>
                <value>
                    <elementReference>$Record.RelatedObjectId</elementReference>
                </value>
            </inputParameters>
            <inputParameters>
                <name>integrationDefinitionName</name>
                <value>
                    <stringValue>IDVCheck</stringValue>
                </value>
            </inputParameters>
            <inputParameters>
                <name>outputRecordID</name>
                <value>
                    <elementReference>$Record.RelatedObjectId</elementReference>
                </value>
            </inputParameters>
            <inputParameters>
                <name>isSkipFlowExecution</name>
                <value>
                    <booleanValue>false</booleanValue>
                </value>
            </inputParameters>
            <label>Initiate Identity Verification</label>
            <requiresAsyncProcessing>true</requiresAsyncProcessing>
            <runAsUser>true</runAsUser>
            <shouldLock>false</shouldLock>
            <stepSubtype>BackgroundStep</stepSubtype>
        </stageSteps>
    </orchestratedStages>
    <orchestratedStages>
        <description>Performs the pre-onboarding actions before onboarding a party profile.</description>
        <name>PerformPartyProfilePreOnboardingActions</name>
        <label>Perform Party Profile Pre-Onboarding Actions</label>
        <locationX>176</locationX>
        <locationY>287</locationY>
        <connector>
            <targetReference>IsThePreOnboardingProcessCompleted</targetReference>
        </connector>
        <exitConditionLogic>and</exitConditionLogic>
        <stageSteps>
            <description>Updates the Flow Orchestration Inst Related Obj record with the Flow Orchestration Instance ID. The flow then gets the Party Profile record that matches the partyProfileId passed into the flow and stores it in a record variable.</description>
            <name>InitiatePreOnboardingProcess</name>
            <actionName>fsc_onboarding__ResumePartyPrflOnb</actionName>
            <actionType>stepBackground</actionType>
            <canAssigneeEdit>false</canAssigneeEdit>
            <debugSimulateStep>false</debugSimulateStep>
            <entryConditionLogic>and</entryConditionLogic>
            <exitConditionLogic>and</exitConditionLogic>
            <inputParameters>
                <name>flowOrchInstRelaObjectId</name>
                <value>
                    <elementReference>$Record.Id</elementReference>
                </value>
            </inputParameters>
            <inputParameters>
                <name>flowOrchestrationInstanceID</name>
                <value>
                    <elementReference>$Orchestration.Instance</elementReference>
                </value>
            </inputParameters>
            <inputParameters>
                <name>partyProfileID</name>
                <value>
                    <elementReference>$Record.RelatedObjectId</elementReference>
                </value>
            </inputParameters>
            <label>Initiate Pre-Onboarding Process</label>
            <requiresAsyncProcessing>false</requiresAsyncProcessing>
            <runAsUser>true</runAsUser>
            <shouldLock>false</shouldLock>
            <stepSubtype>BackgroundStep</stepSubtype>
        </stageSteps>
    </orchestratedStages>
    <orchestratedStages>
        <description>If the screening checks for the party profile aren’t complete, the flow orchestration initiates the screening checks.</description>
        <name>PerformPartyProfileScreeningChecks</name>
        <label>Perform Party Profile Screening Checks</label>
        <locationX>550</locationX>
        <locationY>911</locationY>
        <connector>
            <targetReference>VerifyIdentityVerificationAndScrnCplt</targetReference>
        </connector>
        <exitActionInputParameters>
            <name>isFlowFailed</name>
            <value>
                <elementReference>InitiateScreeningChecks.Outputs.isFlowFailed</elementReference>
            </value>
        </exitActionInputParameters>
        <exitActionInputParameters>
            <name>partyProfileId</name>
            <value>
                <elementReference>$Record.RelatedObjectId</elementReference>
            </value>
        </exitActionInputParameters>
        <exitActionName>fsc_onboarding__CheckScreeningComplete</exitActionName>
        <exitActionType>evaluationFlow</exitActionType>
        <exitConditionLogic>and</exitConditionLogic>
        <stageSteps>
            <description>Checks the stage of the Party Profile and the status of the Party Screening Summary record. If the status of the Party Screening Summary record is Complete, the flow orchestration sets the variable isOrchestrationConditionMet to False. Otherwise, the flow orchestration calls an integration definition to initiate screening checks for the Party Profile.</description>
            <name>InitiateScreeningChecks</name>
            <actionName>fsc_onboarding__InvokeExtlAsyncAction</actionName>
            <actionType>stepBackground</actionType>
            <canAssigneeEdit>false</canAssigneeEdit>
            <debugSimulateStep>false</debugSimulateStep>
            <entryActionInputParameters>
                <name>partyProfileId</name>
                <value>
                    <elementReference>$Record.RelatedObjectId</elementReference>
                </value>
            </entryActionInputParameters>
            <entryActionName>fsc_onboarding__EvalScreeningStatus</entryActionName>
            <entryActionType>evaluationFlow</entryActionType>
            <entryConditionLogic>and</entryConditionLogic>
            <exitConditionLogic>and</exitConditionLogic>
            <inputParameters>
                <name>inputRecordID</name>
                <value>
                    <elementReference>$Record.RelatedObjectId</elementReference>
                </value>
            </inputParameters>
            <inputParameters>
                <name>integrationDefinitionName</name>
                <value>
                    <stringValue>AMLScreening</stringValue>
                </value>
            </inputParameters>
            <inputParameters>
                <name>outputRecordID</name>
                <value>
                    <elementReference>$Record.RelatedObjectId</elementReference>
                </value>
            </inputParameters>
            <inputParameters>
                <name>isSkipFlowExecution</name>
                <value>
                    <booleanValue>false</booleanValue>
                </value>
            </inputParameters>
            <label>Initiate Screening Checks</label>
            <requiresAsyncProcessing>true</requiresAsyncProcessing>
            <runAsUser>true</runAsUser>
            <shouldLock>false</shouldLock>
            <stepSubtype>BackgroundStep</stepSubtype>
        </stageSteps>
    </orchestratedStages>
    <orchestratedStages>
        <description>Evaluates the party profile&apos;s risk level and performs any post-assessment actions.</description>
        <name>PerformRiskAssessment</name>
        <label>Perform Risk Assessment</label>
        <locationX>968</locationX>
        <locationY>1235</locationY>
        <connector>
            <targetReference>DidRiskAssessmentFail</targetReference>
        </connector>
        <exitConditionLogic>and</exitConditionLogic>
        <stageSteps>
            <description>Calls a Business Rules Engine invocable action to initiate the risk assessment for the party profile. The flow then creates a Party Profile Risk record with the details of the initial risk assessment. It also updates the stage of the Party Profile record to Approvals and sets the date for the next party profile review.</description>
            <name>InitiateRiskAssessment</name>
            <actionName>FINS_AssessRiskCategory</actionName>
            <actionType>stepBackground</actionType>
            <canAssigneeEdit>false</canAssigneeEdit>
            <debugSimulateStep>false</debugSimulateStep>
            <entryActionInputParameters>
                <name>partyProfileID</name>
                <value>
                    <elementReference>$Record.RelatedObjectId</elementReference>
                </value>
            </entryActionInputParameters>
            <entryActionName>fsc_onboarding__SetOrchCondRiskAsmt</entryActionName>
            <entryActionType>evaluationFlow</entryActionType>
            <entryConditionLogic>and</entryConditionLogic>
            <exitConditionLogic>and</exitConditionLogic>
            <inputParameters>
                <name>partyProfileId</name>
                <value>
                    <elementReference>$Record.RelatedObjectId</elementReference>
                </value>
            </inputParameters>
            <label>Initiate Risk Assessment</label>
            <requiresAsyncProcessing>false</requiresAsyncProcessing>
            <runAsUser>true</runAsUser>
            <shouldLock>false</shouldLock>
            <stepSubtype>BackgroundStep</stepSubtype>
        </stageSteps>
    </orchestratedStages>
    <orchestratedStages>
        <description>Verifies the completion of identity verification and screening checks for the Party Profile and performs the post-verification actions.</description>
        <name>VerifyIdentityVerificationAndScrnCplt</name>
        <label>Verify Identity Verification and Screening Completion</label>
        <locationX>550</locationX>
        <locationY>1019</locationY>
        <connector>
            <targetReference>WhatIsStatusOfIdentityVerfAndScrnCheck</targetReference>
        </connector>
        <exitConditionLogic>and</exitConditionLogic>
        <stageSteps>
            <description>Verifies the completion of identity verification and screening checks for the party profile. If the checks aren’t complete, the flow orchestration allows the user to retry the checks. If the checks are complete, the flow orchestration updates the stage of the Party Profile record to Document Validation stage.</description>
            <name>ReviewIdentityVerificationAndScreeningStatus</name>
            <actionName>fsc_onboarding__RetryIdVerfScrnChk</actionName>
            <actionType>stepInteractive</actionType>
            <assignees>
                <assignee>
                    <stringValue>FINS_Back_Office</stringValue>
                </assignee>
                <assigneeType>Queue</assigneeType>
            </assignees>
            <canAssigneeEdit>false</canAssigneeEdit>
            <debugSimulateStep>false</debugSimulateStep>
            <entryConditionLogic>and</entryConditionLogic>
            <exitConditionLogic>and</exitConditionLogic>
            <inputParameters>
                <name>errorMessage</name>
                <value>
                    <stringValue>{!InitiateScreeningChecks.Outputs.errorMessage} {!InitiateScreeningChecks.Outputs.errorMessage}</stringValue>
                </value>
            </inputParameters>
            <inputParameters>
                <name>IsIdentityVerificationFailed</name>
                <value>
                    <elementReference>InitiateIdentityVerification.Outputs.isFlowFailed</elementReference>
                </value>
            </inputParameters>
            <inputParameters>
                <name>IsScreeningFailed</name>
                <value>
                    <elementReference>InitiateScreeningChecks.Outputs.isFlowFailed</elementReference>
                </value>
            </inputParameters>
            <inputParameters>
                <name>partyProfileID</name>
                <value>
                    <elementReference>$Record.RelatedObjectId</elementReference>
                </value>
            </inputParameters>
            <inputParameters>
                <name>ActionInput__RecordId</name>
                <value>
                    <elementReference>$Record.RelatedObjectId</elementReference>
                </value>
            </inputParameters>
            <label>Review Identity Verification and Screening Status</label>
            <requiresAsyncProcessing>false</requiresAsyncProcessing>
            <runAsUser>true</runAsUser>
            <shouldLock>false</shouldLock>
            <stepSubtype>InteractiveStep</stepSubtype>
        </stageSteps>
    </orchestratedStages>
    <processMetadataValues>
        <name>BuilderType</name>
        <value>
            <stringValue>LightningFlowBuilder</stringValue>
        </value>
    </processMetadataValues>
    <processMetadataValues>
        <name>CanvasMode</name>
        <value>
            <stringValue>AUTO_LAYOUT_CANVAS</stringValue>
        </value>
    </processMetadataValues>
    <processType>Orchestrator</processType>
    <sourceTemplate>fsc_onboarding__OnboardPartyProfile</sourceTemplate>
    <start>
        <locationX>50</locationX>
        <locationY>0</locationY>
        <connector>
            <targetReference>PerformPartyProfilePreOnboardingActions</targetReference>
        </connector>
        <doesRequireRecordChangedToMeetCriteria>true</doesRequireRecordChangedToMeetCriteria>
        <filterLogic>and</filterLogic>
        <filters>
            <field>RelatedObjectId</field>
            <operator>StartsWith</operator>
            <value>
                <stringValue>0xU</stringValue>
            </value>
        </filters>
        <object>FlowOrchestrationInstRelaObj</object>
        <recordTriggerType>Create</recordTriggerType>
        <triggerType>RecordAfterSave</triggerType>
    </start>
    <status>Active</status>
</Flow>
